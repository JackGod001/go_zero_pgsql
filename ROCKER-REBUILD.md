您需要在以下情况下重新构建镜像：

源代码变更：
当您的 Go 代码发生任何变化时，需要重新构建镜像以包含最新的代码。这包括 cmd/api/user.go 文件或任何其他被 COPY . . 命令复制到容器中的源文件。

依赖变更：
如果您的 go.mod 或 go.sum 文件发生变化，表示项目依赖有更新，需要重新构建镜像以确保使用最新的依赖。

配置文件变更：
当 cmd/api/etc 目录中的配置文件（如 user-api.yaml）发生变化时，需要重新构建镜像以包含更新后的配置。

Dockerfile 变更：
如果您修改了 Dockerfile 本身，比如更改了构建过程、添加了新的环境变量或更改了 CMD 指令，都需要重新构建镜像。

基础镜像更新：
如果您想使用更新的基础镜像（例如，golang:alpine 有新版本），需要重新构建以使用最新的基础镜像。

构建参数变更：
如果您使用了构建参数（ARG 指令），并且这些参数的值需要改变，您需要重新构建镜像。

环境变更：
如果您更改了构建环境（例如，更换了 GOPROXY 的地址），需要重新构建以应用新的环境设置。

新增文件：
如果您在项目中添加了新文件，并且这些文件需要被包含在镜像中，就需要重新构建。

构建优化：
如果您想优化构建过程，例如更改编译标志或优化层顺序，需要重新构建镜像。

安全更新：
如果发现了安全漏洞，需要更新依赖或基础镜像，就需要重新构建。

重要提示：

在开发过程中，频繁重建镜像是正常的，这确保了您的容器始终运行最新的代码和配置。
在生产环境中，应该有一个可控的流程来管理镜像的重建和部署，通常结合持续集成/持续部署（CI/CD）系统来自动化这个过程。
使用 Docker 的构建缓存可以加速重复构建过程，但有时可能需要使用 --no-cache 选项来确保完全干净的构建。